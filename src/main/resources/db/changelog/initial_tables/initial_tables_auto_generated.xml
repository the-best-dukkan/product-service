<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
                      http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.31.xsd"
        objectQuotingStrategy="QUOTE_ONLY_RESERVED_WORDS">
    <changeSet id="1767722003743-1" author="rohitkumar">
        <createTable tableName="brand">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="pk_brand"/>
            </column>
            <column name="created_date" type="DATETIME">
                <constraints nullable="false"/>
            </column>
            <column name="modified_date" type="DATETIME"/>
            <column name="name" type="VARCHAR(300)">
                <constraints nullable="false"/>
            </column>
            <column name="slug" type="VARCHAR(255)"/>
            <column name="status" type="VARCHAR(255)"/>
        </createTable>
    </changeSet>
    <changeSet id="1767722003743-2" author="rohitkumar">
        <createTable tableName="category">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="pk_category"/>
            </column>
            <column name="created_date" type="DATETIME">
                <constraints nullable="false"/>
            </column>
            <column name="modified_date" type="DATETIME"/>
            <column name="name" type="VARCHAR(300)">
                <constraints nullable="false"/>
            </column>
            <column name="slug" type="VARCHAR(255)"/>
            <column name="path" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="level" type="INT"/>
            <column name="is_leaf" type="BOOLEAN"/>
            <column name="status" type="VARCHAR(255)"/>
        </createTable>
    </changeSet>
    <changeSet id="1767722003743-3" author="rohitkumar">
        <createTable tableName="price">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="pk_price"/>
            </column>
            <column name="created_date" type="DATETIME">
                <constraints nullable="false"/>
            </column>
            <column name="modified_date" type="DATETIME"/>
            <column name="sku_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="price_type" type="VARCHAR(255)"/>
            <column name="amount" type="DECIMAL">
                <constraints nullable="false"/>
            </column>
            <column name="currency" type="VARCHAR(255)"/>
            <column name="valid_from" type="DATETIME"/>
            <column name="valid_to" type="DATETIME"/>
        </createTable>
    </changeSet>
    <changeSet id="1767722003743-4" author="rohitkumar">
        <createTable tableName="product">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="pk_product"/>
            </column>
            <column name="created_date" type="DATETIME">
                <constraints nullable="false"/>
            </column>
            <column name="modified_date" type="DATETIME"/>
            <column name="product_code" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="title" type="VARCHAR(300)">
                <constraints nullable="false"/>
            </column>
            <column name="description" type="VARCHAR(4000)"/>
            <column name="brand_id" type="BIGINT"/>
            <column name="status" type="VARCHAR(255)"/>
        </createTable>
    </changeSet>
    <changeSet id="1767722003743-5" author="rohitkumar">
        <createTable tableName="product_category">
            <column name="product_id" type="BIGINT">
                <constraints primaryKey="true" primaryKeyName="pk_product_category"/>
            </column>
            <column name="created_date" type="DATETIME">
                <constraints nullable="false"/>
            </column>
            <column name="modified_date" type="DATETIME"/>
            <column name="category_id" type="BIGINT">
                <constraints primaryKey="true" primaryKeyName="pk_product_category"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet id="1767722003743-6" author="rohitkumar">
        <createTable tableName="product_image">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="pk_product_image"/>
            </column>
            <column name="created_date" type="DATETIME">
                <constraints nullable="false"/>
            </column>
            <column name="modified_date" type="DATETIME"/>
            <column name="product_id" type="BIGINT"/>
            <column name="url" type="VARCHAR(255)"/>
            <column name="position" type="INT"/>
            <column name="is_primary" type="BOOLEAN"/>
        </createTable>
    </changeSet>
    <changeSet id="1767722003743-7" author="rohitkumar">
        <createTable tableName="product_search_document">
            <column name="product_id" type="BIGINT">
                <constraints primaryKey="true" primaryKeyName="pk_product_search_document"/>
            </column>
            <column name="created_date" type="DATETIME">
                <constraints nullable="false"/>
            </column>
            <column name="modified_date" type="DATETIME"/>
            <column name="title" type="VARCHAR(255)"/>
            <column name="brand_name" type="VARCHAR(255)"/>
            <column name="category_path" type="VARCHAR(255)"/>
            <column name="attributes_json" type="jsonb"/>
        </createTable>
    </changeSet>
    <changeSet id="1767722003743-8" author="rohitkumar">
        <createTable tableName="product_status_history">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="pk_product_status_history"/>
            </column>
            <column name="created_date" type="DATETIME">
                <constraints nullable="false"/>
            </column>
            <column name="modified_date" type="DATETIME"/>
            <column name="product_id" type="BIGINT"/>
            <column name="old_status" type="VARCHAR(255)"/>
            <column name="new_status" type="VARCHAR(255)"/>
            <column name="changed_at" type="DATETIME"/>
            <column name="changed_by" type="VARCHAR(255)"/>
        </createTable>
    </changeSet>
    <changeSet id="1767722003743-9" author="rohitkumar">
        <createTable tableName="sku">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="pk_sku"/>
            </column>
            <column name="created_date" type="DATETIME">
                <constraints nullable="false"/>
            </column>
            <column name="modified_date" type="DATETIME"/>
            <column name="sku_code" type="VARCHAR(255)">
                <constraints nullable="false"/>
            </column>
            <column name="product_id" type="BIGINT">
                <constraints nullable="false"/>
            </column>
            <column name="status" type="VARCHAR(255)"/>
            <column name="weight" type="DOUBLE"/>
            <column name="length" type="DOUBLE"/>
            <column name="width" type="DOUBLE"/>
            <column name="height" type="DOUBLE"/>
        </createTable>
    </changeSet>
    <changeSet id="1767722003743-10" author="rohitkumar">
        <createTable tableName="sku_attribute">
            <column name="sku_id" type="BIGINT">
                <constraints primaryKey="true" primaryKeyName="pk_sku_attribute"/>
            </column>
            <column name="created_date" type="DATETIME">
                <constraints nullable="false"/>
            </column>
            <column name="modified_date" type="DATETIME"/>
            <column name="attribute_name" type="VARCHAR(255)">
                <constraints primaryKey="true" primaryKeyName="pk_sku_attribute"/>
            </column>
            <column name="attribute_value" type="VARCHAR(255)"/>
        </createTable>
    </changeSet>
    <changeSet id="1767722003743-11" author="rohitkumar">
        <createTable tableName="sku_image">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="pk_sku_image"/>
            </column>
            <column name="created_date" type="DATETIME">
                <constraints nullable="false"/>
            </column>
            <column name="modified_date" type="DATETIME"/>
            <column name="sku_id" type="BIGINT"/>
            <column name="url" type="VARCHAR(255)"/>
        </createTable>
    </changeSet>
    <changeSet id="1767722003743-12" author="rohitkumar">
        <createTable tableName="sku_price_history">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="pk_sku_price_history"/>
            </column>
            <column name="created_date" type="DATETIME">
                <constraints nullable="false"/>
            </column>
            <column name="modified_date" type="DATETIME"/>
            <column name="sku_id" type="BIGINT"/>
            <column name="old_price" type="DECIMAL"/>
            <column name="new_price" type="DECIMAL"/>
            <column name="changed_at" type="DATETIME"/>
        </createTable>
    </changeSet>
    <changeSet id="1767722003743-13" author="rohitkumar">
        <createTable tableName="sku_tax">
            <column name="sku_id" type="BIGINT">
                <constraints primaryKey="true" primaryKeyName="pk_sku_tax"/>
            </column>
            <column name="created_date" type="DATETIME">
                <constraints nullable="false"/>
            </column>
            <column name="modified_date" type="DATETIME"/>
            <column name="tax_category_id" type="BIGINT">
                <constraints primaryKey="true" primaryKeyName="pk_sku_tax"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet id="1767722003743-14" author="rohitkumar">
        <createTable tableName="tax_category">
            <column autoIncrement="true" name="id" type="BIGINT">
                <constraints nullable="false" primaryKey="true" primaryKeyName="pk_tax_category"/>
            </column>
            <column name="created_date" type="DATETIME">
                <constraints nullable="false"/>
            </column>
            <column name="modified_date" type="DATETIME"/>
            <column name="name" type="VARCHAR(255)"/>
            <column name="percentage" type="DECIMAL"/>
        </createTable>
    </changeSet>
    <changeSet id="1767722003743-15" author="rohitkumar">
        <addUniqueConstraint columnNames="name" constraintName="uc_brand_name" tableName="brand"/>
    </changeSet>
    <changeSet id="1767722003743-16" author="rohitkumar">
        <addUniqueConstraint columnNames="name" constraintName="uc_category_name" tableName="category"/>
    </changeSet>
    <changeSet id="1767722003743-17" author="rohitkumar">
        <addUniqueConstraint columnNames="product_code" constraintName="uc_product_product_code" tableName="product"/>
    </changeSet>
    <changeSet id="1767722003743-18" author="rohitkumar">
        <addUniqueConstraint columnNames="sku_code" constraintName="uc_sku_sku_code" tableName="sku"/>
    </changeSet>
    <changeSet id="1767722003743-19" author="rohitkumar">
        <addForeignKeyConstraint baseColumnNames="sku_id" baseTableName="price" constraintName="FK_PRICE_ON_SKU"
                                 referencedColumnNames="id" referencedTableName="sku"/>
    </changeSet>
    <changeSet id="1767722003743-20" author="rohitkumar">
        <addForeignKeyConstraint baseColumnNames="product_id" baseTableName="product_image"
                                 constraintName="FK_PRODUCT_IMAGE_ON_PRODUCT" referencedColumnNames="id"
                                 referencedTableName="product"/>
    </changeSet>
    <changeSet id="1767722003743-21" author="rohitkumar">
        <addForeignKeyConstraint baseColumnNames="brand_id" baseTableName="product" constraintName="FK_PRODUCT_ON_BRAND"
                                 referencedColumnNames="id" referencedTableName="brand"/>
    </changeSet>
    <changeSet id="1767722003743-22" author="rohitkumar">
        <addForeignKeyConstraint baseColumnNames="sku_id" baseTableName="sku_image" constraintName="FK_SKU_IMAGE_ON_SKU"
                                 referencedColumnNames="id" referencedTableName="sku"/>
    </changeSet>
    <changeSet id="1767722003743-23" author="rohitkumar">
        <addForeignKeyConstraint baseColumnNames="product_id" baseTableName="sku" constraintName="FK_SKU_ON_PRODUCT"
                                 referencedColumnNames="id" referencedTableName="product"/>
    </changeSet>

</databaseChangeLog>